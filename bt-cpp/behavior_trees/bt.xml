<?xml version="1.0" encoding="UTF-8"?>
<root BTCPP_format="4">
  <BehaviorTree ID="Untitled">
    <Fallback>
      <Parallel failure_count="1"
                success_count="-1">
        <Sequence name="MainLoop">
          <Subscriber name="WaitingCall"
                      message="{call}"
                      wait_duration_sec="{duration}"/>
          <CalculateTTC ttc="{ttc}"/>
          <Fallback>
            <Sequence name="AssistPatient">
              <Fallback>
                <HasAllItems status="{items}"/>
                <Sequence name="GrabEquipmentNeeded">
                  <CalculateTTC ttc="{ttc}"/>
                  <GoToPose x="{x}" y="{y}" yaw="{yaw}"/>
                  <Grab movement="{equipment}"/>
                </Sequence>
              </Fallback>
              <GoToPose x="{x}" y="{y}" yaw="{yaw}"/>
              <Sequence>
                <Interaction message="{test}"/>
                <TestSequence test="{test}"/>
              </Sequence>
            </Sequence>
            <Publisher name="AlertNurse"
                       message="{alert}"
                       number="{number}"/>
          </Fallback>
        </Sequence>
        <CheckBattery over10percent="{has_battery}"/>
      </Parallel>
      <Sequence>
        <GoToPose x="{x}" y="{y}" yaw="{yaw}"/>
        <Publisher name="AlertManager"
                   message="{alert}"
                   number="{number}"/>
      </Sequence>
    </Fallback>
  </BehaviorTree>

  <!-- Description of Node Models (used by Groot) -->
  <TreeNodesModel>
    <Action ID="CalculateTTC"
            editable="true">
      <output_port name="ttc"
                   default="{ttc}"/>
    </Action>
    <Action ID="CheckBattery"
            editable="true">
      <output_port name="over10percent"
                   default="{has_battery}"/>
    </Action>
    <Action ID="GoToPose"
            editable="true">
      <input_port name="x"/>
      <input_port name="y"/>
      <input_port name="yaw"/>
    </Action>
    <Action ID="Grab"
            editable="true">
      <output_port name="movement"/>
    </Action>
    <Condition ID="HasAllItems"
               editable="true">
      <output_port name="status"
                   default="{items}"/>
    </Condition>
    <Action ID="Interaction"
            editable="true">
      <output_port name="message"/>
    </Action>
    <Action ID="Publisher"
            editable="true">
      <input_port name="message"/>
      <input_port name="number"/>
    </Action>
    <Action ID="Subscriber"
            editable="true">
      <output_port name="message"/>
      <input_port name="wait_duration_sec"/>
    </Action>
    <Action ID="TestSequence"
            editable="true">
      <output_port name="test"
                   default="{test}"/>
    </Action>
  </TreeNodesModel>

</root>